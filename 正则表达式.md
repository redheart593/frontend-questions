# 正则表达式

### 一、正则表达式基础语法

#### 1. **创建正则表达式**

- **字面量形式**（推荐）：

  ```
  const regex = /pattern/modifiers;
  ```

  - `pattern`: 匹配规则（如 `\d` 匹配数字）
  - `modifiers`: 修饰符（如 `i` 忽略大小写，`g` 全局匹配）

- **构造函数形式**（动态生成时使用）：

  ```
  const regex = new RegExp('pattern', 'modifiers');
  ```

------

#### 2. **常用元字符**

| 元字符 | 说明                          | 示例                                 |      |                        |
| :----- | :---------------------------- | :----------------------------------- | ---- | ---------------------- |
| `.`    | 匹配除换行外的任意字符        | `a.c` → "abc", "a1c"                 |      |                        |
| `^`    | 匹配字符串的开始              | `^Hello` → 匹配以 Hello 开头的字符串 |      |                        |
| `$`    | 匹配字符串的结束              | `world$` → 匹配以 world 结尾的字符串 |      |                        |
| `\d`   | 匹配数字（等价于 `[0-9]`）    | `\d{3}` → 匹配 3 位数字              |      |                        |
| `\w`   | 匹配字母、数字、下划线        | `\w+` → 匹配一个单词                 |      |                        |
| `\s`   | 匹配空白符（空格、制表符等）  | `\s+` → 匹配多个空格                 |      |                        |
| `\D`   | 匹配非数字（等价于 `[^0-9]`） |                                      |      |                        |
| `      | `                             | 逻辑或                               | `cat | dog` → 匹配 cat 或 dog |

------

#### 3. **字符类（Character Classes）**

- **`[abc]`**：匹配 a、b 或 c 中的任意一个字符。

  ```
  /gr[ae]y/.test('grey'); // true（匹配 "gray" 或 "grey"）
  ```

- **`[^abc]`**：匹配不在 a、b、c 中的任意字符。

  ```
  /[^0-9]/.test('a'); // true（匹配非数字字符）
  ```

------

#### 4. **量词（Quantifiers）**

| 量词    | 说明                       | 示例                            |
| :------ | :------------------------- | :------------------------------ |
| `*`     | 匹配前一个元素 0 次或多次  | `a*` → "", "a", "aa"            |
| `+`     | 匹配前一个元素 1 次或多次  | `a+` → "a", "aa"                |
| `?`     | 匹配前一个元素 0 次或 1 次 | `colou?r` → "color" 或 "colour" |
| `{n}`   | 匹配前一个元素恰好 n 次    | `\d{3}` → 3 位数字              |
| `{n,}`  | 匹配前一个元素至少 n 次    | `a{2,}` → "aa", "aaa"           |
| `{n,m}` | 匹配前一个元素 n 到 m 次   | `a{2,4}` → "aa", "aaa", "aaaa"  |

------

#### 5. **分组和捕获**

- **`(pattern)`**：将多个字符分组，并捕获匹配内容。

  ```
  const regex = /(\d{4})-(\d{2})-(\d{2})/;
  const match = regex.exec('2023-10-01');
  console.log(match[1]); // "2023"（年）
  console.log(match[2]); // "10"（月）
  ```

- **非捕获分组 `(?:pattern)`**：分组但不捕获。

  ```
  /(?:https?):\/\/([^/]+)/.exec('https://www.example.com');
  // 捕获组 1: "www.example.com"
  ```

------

#### 6. **修饰符（Flags）**

| 修饰符 | 说明                                        |
| :----- | :------------------------------------------ |
| `i`    | 忽略大小写                                  |
| `g`    | 全局匹配（查找所有匹配项）                  |
| `m`    | 多行模式（`^` 和 `$` 匹配每行的开始和结束） |
| `s`    | 允许 `.` 匹配换行符（ES2018+）              |

------

### 二、正则表达式在 JavaScript 中的使用

#### 1. **字符串方法**

- **`test()`**：检测字符串是否匹配正则。

  ```
  /hello/i.test('Hello World'); // true（忽略大小写）
  ```

- **`exec()`**：返回匹配结果的详细信息（包含捕获组）。

  ```
  const regex = /\d+/g;
  regex.exec('2023年10月'); // ["2023", index:0]
  ```

- **`match()`**：返回所有匹配项（全局模式）。

  ```
  'a1b2c3'.match(/\d/g); // ["1", "2", "3"]
  ```

- **`replace()`**：替换匹配内容。

  ```
  'Hello World'.replace(/world/i, 'JavaScript'); // "Hello JavaScript"
  ```

- **`split()`**：按正则分割字符串。

  ```
  'a,b, c'.split(/\s*,\s*/); // ["a", "b", "c"]
  ```

------

#### 2. **常见用例**

##### 1) 验证邮箱格式

```
const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
console.log(emailRegex.test('user@example.com')); // true
```

##### 2) 提取 URL 中的域名

```
const urlRegex = /^(?:https?:\/\/)?([^/?#]+)/i;
const url = 'https://www.example.com/path';
console.log(url.match(urlRegex)[1]); // "www.example.com"
```

##### 3) 移除字符串中的 HTML 标签

```
const html = '<div>Hello <b>World</b></div>';
const cleanText = html.replace(/<[^>]+>/g, '');
console.log(cleanText); // "Hello World"
```

##### 4) 匹配日期格式（YYYY-MM-DD）

```
const dateRegex = /^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$/;
console.log(dateRegex.test('2023-10-01')); // true
```

------

### 三、高级技巧

#### 1. **贪婪匹配 vs 懒惰匹配**

- **贪婪匹配**（默认）：尽可能匹配更长的字符串。

  ```
  /<.*>/.exec('<div>text</div>')[0]; // "<div>text</div>"
  ```

- **懒惰匹配**（使用 `?`）：尽可能匹配更短的字符串。

  ```
  /<.*?>/.exec('<div>text</div>')[0]; // "<div>"
  ```

#### 2. **正向预查和负向预查**

- **正向肯定预查 `(?=pattern)`**：匹配后面跟着 `pattern` 的位置。

  ```
  /\d+(?=%)/.exec('100%'); // "100"（匹配后面有 % 的数字）
  ```

- **负向肯定预查 `(?<!pattern)`**：匹配后面不跟着 `pattern` 的位置。

  ```
  /(?<!-)\d+/.exec('-42'); // null（匹配不以 - 开头的数字）
  ```

------

### 四、工具与调试

- **在线测试工具**：
  - [Regex101](https://regex101.com/)（支持多语言）
  - [RegExr](https://regexr.com/)（实时高亮）
- **JavaScript 正则表达式可视化工具**：
  - [Regexper](https://regexper.com/)

------

### 五、总结

| **场景**       | **正则表达式示例**                                   |                 |           |           |
| :------------- | :--------------------------------------------------- | --------------- | --------- | --------- |
| 验证邮箱       | `/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/` |                 |           |           |
| 提取 URL 域名  | `/^(?:https?:\/\/)?([^/?#]+)/i`                      |                 |           |           |
| 匹配日期       | `/^\d{4}-(0[1-9]                                     | 1[0-2])-(0[1-9] | [12][0-9] | 3[01])$/` |
| 替换 HTML 标签 | `/<[^>]+>/g`                                         |                 |           |           |